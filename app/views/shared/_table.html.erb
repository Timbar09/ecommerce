<!-- app/views/shared/_table.html.erb -->
<div class="table__container radius-xl">
  <table class="table">
    <thead>
      <tr>
        <% headers.each do |header| %>
          <th>
            <% if header == :id %>
              SKU
            <% elsif header == :product_name %>
              Product
            <% else %>
              <%= header.to_s.titleize %>
            <% end %>
          </th>
        <% end %>
      </tr>
    </thead>

    <tfoot class="table__footer">
      <tr>
        <td colspan="<%= headers.size %>">
          <div class="table__footer--container flex ai-center jc-between px-2 py-3">
            <button class="table__footer--prev table__footer--nav__button flex ai-center gap-1 radius-md py-1 pr-2">
              <%= render 'shared/icon', name: "chevron-left" %>
              Prev
            </button>

            <ul class="table__footer--pages flex">
              <li class="table__footer--page">
                <button class="table__footer--page__button px-1 radius-md">1</button>
              </li>

              <li class="table__footer--page">
                <button class="table__footer--page__button px-1 radius-md">2</button>
              </li>

              <li class="table__footer--page">
                <button class="table__footer--page__button px-1 radius-md">3</button>
              </li>
            </ul>

            <button class="table__footer--next table__footer--nav__button flex ai-center gap-1 radius-md py-1 pl-2">
              Next
              <%= render 'shared/icon', name: "chevron-right" %>
            </button>
          </div>
        </td>
      </tr>
    </tfoot>

    <tbody>
      <% specific_attributes = {
        image: ->(item) { item.respond_to?(:image) && item.image.attached? ? image_tag(item.image.variant(:thumb), class: "table__image radius-md") : item.respond_to?(:images) && item.images.any? ? image_tag(item.images.first.variant(:thumb), class: "table__image radius-md") : image_tag("https://via.placeholder.com/50", class: "table__image radius-md") },
        product_name: ->(item) { "#{item.product.name} (#{item.product.category.name})" },
        actions: ->(item) { 
          render 'shared/options_modal' do
            content_tag(:ul, class: "modal__list p-1") do
              actions.map do |action|
                content_tag(:li, class: "modal__list--item") do
                  link_to action[:path].call(item), method: action[:method], class: "modal__list--link" do
                    action[:name]
                  end
                end
              end.join.html_safe
            end
          end
        }
      } %>

      <% list.each do |item| %>
        <tr class="table__row table__row--<%= item.class.name.downcase %>">
          <% headers.each do |attribute| %>
            <td class="table__<%= attribute == :image || attribute == :image ? "image--container" : attribute %>">
              <%= specific_attributes[attribute] ? specific_attributes[attribute].call(item) : item.send(attribute) %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>