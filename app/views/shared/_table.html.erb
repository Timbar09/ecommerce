<div class="table__container radius-xl">
  <table class="table">
    <thead>
      <tr>
        <% headers.each do |header| %>
          <th>
            <% if header == :id %>
              SKU
            <% elsif header == :product_name %>
              Belongs To
            <% else %>
              <%= header.to_s.titleize %>
            <% end %>
          </th>
        <% end %>
      </tr>
    </thead>

    <%= render 'shared/table_footer', col_span: headers.size %>

    <tbody>
      <% specific_attributes = {
        image: ->(item) { image_tag(item.display_thumb_image, class: "table__image radius-md") },
        product_name: ->(item) { item.display_product_name },
        size: ->(item) { item.size.upcase },
        id: ->(item) { item.display_sku },
        price: ->(item) { number_to_currency(item.price) },
        actions: ->(item) { 
          render 'shared/options_modal' do
            content_tag(:ul, class: "modal__list p-1") do
              actions.map do |action|
                content_tag(:li, class: "modal__list--item") do
                  if action[:method] == :delete
                    button_to action[:name], action[:path].call(item), method: :delete, class: "modal__list--link", data_action: "click->options-modal#close"
                  else
                    link_to action[:name], action[:path].call(item), method: action[:method], class: "modal__list--link", data_action: "click->options-modal#close"
                  end
                end
              end.join.html_safe
            end
          end
        }
      } %>

      <% list.each do |item| %>
        <tr class="table__row table__row--<%= item.class.name.downcase %>">
          <% headers.each do |attribute| %>
            <td class="table__<%= attribute == :image || attribute == :image ? "image--container" : attribute %>">
              <%= specific_attributes[attribute] ? specific_attributes[attribute].call(item) : item.send(attribute) %>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>